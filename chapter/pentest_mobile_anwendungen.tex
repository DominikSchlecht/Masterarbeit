\chapter{Penetrationstests mobiler Anwendungen}
Durch eine zunehmende Anfrage des Marktes auf mobile Anwendungen entwickelt die Allianz Deutschland AG zunehmende mobile Applikationen. Dafür müssen nicht nur die bestehenden Prozesse angepasst, sonder auch neue Werkzeuge geschaffen werden, welche die Security-Prozesse unterstützen.\\

Im Folgenden sind die Anforderungen an ein solches Werkzeug festgehalten, gefolgt mit einer Evaluierung bestehenden Programme. Daraufhin wurde ein passendes Werkzeug ausgewählt und die Weiterentwicklung dieses unter Abschnitt \ref{Weiterentwicklung MobSF} beschrieben. Abschließend werden die erreichten mit den ursprünglichen Anforderungen verglichen.

\section{Anforderungen}\label{ref:PenMobAnwdWeiterAnford}
Im Folgenden sind die Anforderungen festgehalten, welche für einen echt-Einsatz in der Allianz Deutschland AG notwendig sind.

\begin{description}
	\item[Einfache Einrichtung] Ebenso sollte das Tool möglichst unkompliziert einem Benutzer zur Verfügung gestellt werden können. Dies könnte entweder über eine einfache Installation oder durch die Ausführung auf einer zentralen, erreichbaren Instanz realisiert werden.
	
	\item[Einfache Handhabung] Im Optimalfall soll ein Scan bereits nach einer kurzen Einführungszeit durch einen zuvor ungeschulten Mitarbeiter durchgeführt werden können.  Dazu muss das Tool einfach bedienbar sein.
	
	\item[Verständliche Ergebnisse] Die Ergebnisse des Werkzeugs sollten für einen in der Informationssichereit arbeitenden Angestellten verständlich sein. Hier kann eine gewisse Fachkentniss vorausgesetzt werden und Grundlagen (wie zum Beispiel warum \textit{memcpy} auf eine mögliche Schwachstelle hinweist) müssen durch das Werkzeug nicht vermittelt werden.
	
	\item[Unterstützung für \textit{Android}/\textit{iOS}/\textit{Windows Phone}] Um zu verhindern, dass für jede der aktuell geläufigen Plattformen ein eigenes Werkzeug genutzt werden muss, sollte das Werkzeug die Analyse von Apps für \textit{Android}, \textit{iOS} und \textit{Windows Phone} unterstützen.
	
	\item[Niedrige False-Positive-Rate] Das Werkzeug sollte eine möglichst geringe Rate an \textit{False-Positives}, also falschen Meldungen, aufweisen. Jedoch sollten auch keine Hinweise auf Schwachstellen verworfen werden, sodass das Werkzeug eine  Einstufung der Ergebnisse vornehmen sollte.
	
	\item[Reproduzierbarkeit] Das Werkzeug sollte reproduzierbare Ergebnisse liefern, also bei gleichen Eingangswert das gleiche Ergebnis generieren. Dies für die Nachverfolgung von Meldungen äußert wichtig.
	
\end{description}

\input{chapter/pentest_mobile_anwendungen/bestehende_anwendungen}

\input{chapter/pentest_mobile_anwendungen/vergleich_aktuelle_situation}

\section{Abgleich der Anforderungen mit MobSF}

Im Folgenden Abschnitt werden die Anforderungen aus \ref{ref:PenMobAnwdWeiterAnford} mit den bestehenden Eigenschaften von MobSF abgeglichen.

\begin{description}
	\item[Einfache Einrichtung] MobSF benötigt keine echte Installation, sondern kann einfach aus dem Github-Repository heruntergeladen werden. Die anschließenden Konfigurationsschritte unterscheiden sich leicht nach Betriebssystem, besteht jedoch grundsätzlich immer aus der Installation von Python sowie die Installation der Abhängigkeiten über das Python-Tool \textit{pip}. Abschließend sollten die Einstellungen an die Umgebung angepasst werden. Damit ist die Installation nicht trivial, aber gut dokumentiert und durch eine Person mit Fachkenntnis in kurzer Zeit durchzuführen.
	
	\item[Einfache Handhabung] Die Handhabung von MobSF wird über eine HTML-Oberfläche abgebildet. Samples können per Drag-n-Drop zur Analyse eingereicht werden. Die Realisierung als Web-Anwendung hat den Vorteil, dass das Tool zentral installiert und von verschiedenen Orten über das Netzwerk genutzt werden kann.
	
	\item[Verständliche Ergebnisse] Die Ergebnisse einer Analyse werden ebenfalls in der HTML-Anwendung dargestellt. Dabei über Farb-Codes zumindest einfach zu erkennen, ob Probleme mit der App bestehen. Eine genaue Analyse der Ergebnisse und weiterführende Untersuchungen sollten jedoch durch Experten durchgeführt werden.
	
	\item[Unterstützung für Android/iOS/Windows Phone] Vor der Weiterentwicklung von MobSF unterstütze das Framework die statische und dynamische Analyse von Android-Apps sowie die statische Analyse von iOS-Apps.
	
	\item[Niedrige False-Positive-Rate] MobSF beschreibt nicht direkt Schwachstellen, sondern Indikatoren für zum Beispiel die Verwendung von verwundbaren Funktionen oder angeforderte Rechte. Daher sind die gegeben Warnungen stets korrekt, jedoch wird womöglich auch in machen Bereichen nicht alles entdeckt.
	
	\item[Reproduzierbarkeit] MobSF benutzt zumeist Tools, welche in MobSF selbst enthalten sind. Daher sollte die selbe Version von MobSF auch auf verschiedenen Rechnern gleiche Ergebnisse liefern.
	
\end{description}

Somit sind alle Anforderungen bis auf die Unterstützung von Windows-Phone-Apps ausreichend erfüllt.
	
\section{Laboraufbau}
Zur Weiterentwicklung des \textit{Mobile Security Frameworks} wurde unterschiedliche Hardware mit verschiedenen Werkzeugen genutzt.\\

Als Hardware wurde durch die Allianz Deutschland AG ein Apple Mac-Book Pro mit ausreichenden Ressourcen gestellt (i7, 16GB RAM). Als Betriebssystem wurde anfangs Mac OS X Maverick und später Sierra verwendet.\\

Um die Entwicklung für Windows-spezifische Anwendungen zu realisieren, wurde eine virtuelle Maschine mit \textit{Windows  10} über \textit{VMWare Fusion} verwendet.\\

Als Software wurde Python in Version 2.7 oder 3.6 sowie die jeweiligen Abhängigkeiten in Form von Modulen genutzt.\\

Als Entwicklungsumgebung wurde \textit{Atom} oder \textit{VIM} mit Python 2/3 genutzt.

%\section{Entwicklung der Umgebung}
%	\subsection{Aufbau}
	

%	\subsection{Schnittstellen}

\input{chapter/pentest_mobile_anwendungen/weiterentw_mobsf}		

  
\section{Abgleich mit Anforderungen}
Durch die Weiterentwicklung des MobSF wurde vor allem der Punkt "`Unterstützung von Android/iOS/Windows Phone"' verbessert. So ist nun eine statische Analyse von Windows-Phone-Apps über die Tools des Windows SDL möglich. Zudem wurde die Grundlage für eine dynamische Analyse von iOS-Apps geschaffen. Auch wurde die statische Analyse von iOS-Apps erweitert, was bessere Ergebnisse zur Folge hat.\\

Somit sind alle Anforderungen aus \ref{ref:PenMobAnwdWeiterAnford} ausreichend erfüllt.


\section{Anwendung der Umgebung}
	Im Folgenden wird die weiterentwickelte Version des \textit{MobSF} auf zwei selbstgeschriebene Applikationen angewendet. Dabei Handelt es sich bei Anwendung 1 um eine Windows-Phone-App und bei Applikation 2 um eine iOS-App.

	\subsection{Test Anwendung 1 - Windows-Phone}
	TODO
	Unsichere Funktionen
	
	\subsection{Test Anwendung 2 - iOS}
	TODO
	Zur Entwicklung der Test-Applikation wurde XCode-8 verwendet. Die vollständigen Source-Dateien sind dabei unter TODO oder auf dem beigelegten Datenträger zu finden.\\
	
	Die Analyse der App in \textit{MobSF} ergibt das in Grafik TODO dargestellte Ergebnis.
	
	TODO Bild der Analyse
	Quellcode
		Memory-Corruption
		Unsichere Verbindungen
	
	
